<!DOCTYPE html>
<html lang="en">
  <head>
    <title>MasterpassQRCoreSDK  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="MasterpassQRCoreSDK  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          MasterpassQRCoreSDK Docs
        </a>
        
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">MasterpassQRCoreSDK Reference</a>
      <img class="carat" src="img/carat.png" />
      MasterpassQRCoreSDK  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Categories.html">Categories</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Categories/NSString(NSString_CheckNumber).html">NSString(NSString_CheckNumber)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Categories/NSString(NSString_PatternMatching).html">NSString(NSString_PatternMatching)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/AbstractData.html">AbstractData</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/AdditionalDataTag.html">AdditionalDataTag</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CurrencyEnumLookup.html">CurrencyEnumLookup</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/LanguageData.html">LanguageData</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/LanguageTag.html">LanguageTag</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes.html#/c:objc(cs)MAIData">MAIData</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MPQRError.html">MPQRError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PPTag.html">PPTag</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PushPaymentData.html">PushPaymentData</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/TLV.html">TLV</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/TagInfo.html">TagInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/TemplateData.html">TemplateData</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/TemplateDataTag.html">TemplateDataTag</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes.html#/c:objc(cs)UnrestrictedData">UnrestrictedData</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Constants.html">Constants</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@MPQRErrorDomain">MPQRErrorDomain</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@MPQRErrorMessageKey">MPQRErrorMessageKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@MPQRErrorTagInfoKey">MPQRErrorTagInfoKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@MPQRErrorTagValueKey">MPQRErrorTagValueKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@MPQRErrorTagsKey">MPQRErrorTagsKey</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums.html#/c:@E@CurrencyEnum">CurrencyEnum</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MPQRErrorCode.html">MPQRErrorCode</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/TipConvenienceIndicator.html">TipConvenienceIndicator</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            
            <h1 id='masterpass-qr-core-sdk' class='heading'>Masterpass QR Core SDK</h1>

<p>This SDK provides parser for parsing Push Payment QR code.</p>

<p>You can use this SDK to generate Push Payment QR code string also by filling the data and using <code>PushPaymentData.generatePushPaymentString()</code>. See documentation for more information.</p>

<p><em>This sdk only deals with actual QR code strings. So you need to use a separate QR scanning SDK to get QR code strings. You can use <a href="https://www.github.com/Mastercard/masterpass-qr-scan-sdk-ios">Masterpass QR Scan SDK</a></em></p>

<p><em>This SDK is developed in Objective-C and it works with Swift.</em></p>
<h3 id='requirements' class='heading'>Requirements:</h3>

<ol>
<li>Xcode 9.0+</li>
<li>iOS 8.0+</li>
</ol>
<h3 id='features' class='heading'>Features:</h3>

<ol>
<li>Capabilities to parse and validate Push Payment QR code string.</li>
<li>Generate Push Payment QR code string.</li>
</ol>
<h3 id='installation' class='heading'>Installation</h3>
<h4 id='cocoapods' class='heading'>Cocoapods</h4>

<ul>
<li>In your <em>Podfile</em> write the following</li>
</ul>
<pre class="highlight plaintext"><code>  use_frameworks!
  pod 'MasterpassQRCoreSDK'
</code></pre>

<ul>
<li>Do <code>pod install</code></li>
<li>Everything is setup now</li>
</ul>
<h4 id='manual' class='heading'>Manual</h4>
<h5 id='swift' class='heading'>Swift</h5>

<ul>
<li>Download the latest release of <a href="https://www.github.com/Mastercard/masterpass-qr-core-sdk-ios/releases/download/2.0.0/masterpassqrcoresdk-framework-ios.zip">Masterpass QR Core SDK</a>.</li>
<li>Unzip the file.</li>
<li>Go to your Xcode project’s target “General” settings. Drag MasterpassQRCoreSDK.framework to the “Embedded Binaries” section. Make sure to select <strong>Copy items if needed</strong> and click Finish.</li>
<li><p>Create a new <strong>Run Script Phase</strong> in your app’s target’s <strong>Build Phases</strong> and paste the following snippet in the script text field:</p>

<p><code>bash &quot;${BUILT_PRODUCTS_DIR}/${FRAMEWORKS_FOLDER_PATH}/MasterpassQRCoreSDK.framework/strip-frameworks.sh&quot;</code></p></li>
</ul>

<p>This step is required to work around an App Store submission bug when archiving universal binaries.</p>
<h5 id='objective-c' class='heading'>Objective-C</h5>

<ul>
<li>Follow same instructions as Swift</li>
<li>Go to your Xcode project&rsquo;s <strong>Build Settings</strong> and set <strong>Always Embed Swift Standard Libraries</strong> to <strong>YES</strong></li>
</ul>
<h3 id='usage' class='heading'>Usage</h3>
<h4 id='parsing' class='heading'>Parsing</h4>

<p><strong>Swift</strong></p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">MasterpassQRCoreSDK</span>

<span class="kd">func</span> <span class="nf">parseQRCode</span><span class="p">(</span><span class="nv">code</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">do</span> <span class="p">{</span>
      <span class="c1">// Parse qr code</span>
      <span class="k">let</span> <span class="nv">pushData</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">MPQRParser</span><span class="o">.</span><span class="nf">parse</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span><span class="n">code</span><span class="p">)</span>
      <span class="c1">// Print data in string format</span>
      <span class="nf">print</span><span class="p">(</span><span class="n">pushData</span><span class="o">.</span><span class="nf">dumpData</span><span class="p">())</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="k">let</span> <span class="nv">error</span> <span class="k">as</span> <span class="kt">MPQRError</span><span class="p">{</span>
      <span class="k">if</span> <span class="k">let</span> <span class="nv">str</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="nf">getString</span><span class="p">(){</span>
           <span class="nf">print</span><span class="p">(</span><span class="s">"Error: </span><span class="se">\(</span><span class="n">str</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
      <span class="p">}</span><span class="k">else</span>
      <span class="p">{</span>
          <span class="nf">print</span><span class="p">(</span><span class="s">"Unknown error occurred </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
      <span class="p">}</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
      <span class="nf">print</span><span class="p">(</span><span class="s">"Unknown error occurred </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><strong>Objective-C</strong></p>
<pre class="highlight objective_c"><code><span class="k">@import</span> <span class="n">MasterpassQRCoreSDK</span><span class="p">;</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">parseQRCode</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">code</span> <span class="p">{</span>
    <span class="n">PushPaymentData</span> <span class="o">*</span><span class="n">pushPaymentData</span><span class="p">;</span>
    <span class="n">NSString</span><span class="o">*</span> <span class="p">(</span><span class="o">^</span><span class="n">handleError</span><span class="p">)(</span><span class="n">MPQRError</span> <span class="o">*</span><span class="p">)</span> <span class="o">=</span> <span class="o">^</span><span class="n">NSString</span><span class="o">*</span> <span class="p">(</span><span class="n">MPQRError</span><span class="o">*</span> <span class="n">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">.</span><span class="n">domain</span> <span class="o">==</span> <span class="n">MPQRErrorDomain</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="s">@"Error: %@"</span><span class="p">,</span> <span class="p">[</span><span class="n">error</span> <span class="nf">getString</span><span class="p">]];</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="s">@"Unkown error occured %@"</span><span class="p">,</span> <span class="n">error</span><span class="p">];</span>
    <span class="p">};</span>

    <span class="n">MPQRError</span> <span class="o">*</span><span class="n">error</span><span class="p">;</span>
    <span class="n">pushPaymentData</span> <span class="o">=</span> <span class="p">[</span><span class="n">MPQRParser</span> <span class="nf">parse</span><span class="p">:</span><span class="n">code</span> <span class="nf">error</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="n">handleError</span><span class="p">(</span><span class="n">error</span><span class="p">));</span>
    <span class="p">}</span><span class="k">else</span>
    <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">([</span><span class="n">pushPaymentData</span> <span class="nf">dumpData</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h4 id='generating' class='heading'>Generating</h4>

<p><strong>Swift</strong></p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">CoreImage</span>

<span class="kd">func</span> <span class="nf">generateQRCode</span><span class="p">(</span><span class="n">from</span> <span class="nv">string</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UIImage</span><span class="p">?</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="nf">data</span><span class="p">(</span><span class="nv">using</span><span class="p">:</span> <span class="kt">String</span><span class="o">.</span><span class="kt">Encoding</span><span class="o">.</span><span class="n">utf8</span><span class="p">)</span>

    <span class="k">if</span> <span class="k">let</span> <span class="nv">filter</span> <span class="o">=</span> <span class="kt">CIFilter</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"CIQRCodeGenerator"</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">filter</span><span class="o">.</span><span class="nf">setValue</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"inputMessage"</span><span class="p">)</span>
        <span class="c1">// Set scale according to your device display. If the qr code is blurry then increase scale</span>
        <span class="k">let</span> <span class="nv">transform</span> <span class="o">=</span> <span class="kt">CGAffineTransform</span><span class="p">(</span><span class="nv">scaleX</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="k">let</span> <span class="nv">output</span> <span class="o">=</span> <span class="n">filter</span><span class="o">.</span><span class="n">outputImage</span><span class="p">?</span><span class="o">.</span><span class="nf">transformed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">transform</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kt">UIImage</span><span class="p">(</span><span class="nv">ciImage</span><span class="p">:</span> <span class="n">output</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">nil</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">generatePushPaymentQR</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Generate</span>
    <span class="k">let</span> <span class="nv">pushPaymentData</span> <span class="o">=</span> <span class="kt">PushPaymentData</span><span class="p">()</span>
    <span class="c1">// Set required properties on push payment data e.g pushPaymentData.payloadFormatIndicator = "01"</span>
    <span class="k">var</span> <span class="nv">ppdString</span><span class="p">:</span><span class="kt">String</span><span class="p">?</span>
    <span class="k">do</span> <span class="p">{</span>
        <span class="c1">// Validate generated data</span>
        <span class="n">ppdString</span> <span class="o">=</span> <span class="k">try</span> <span class="n">pushPaymentData</span><span class="o">.</span><span class="nf">generatePushPaymentString</span><span class="p">()</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Error occurred during validation </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="p">}</span>

    <span class="c1">// Generate image</span>
    <span class="k">let</span> <span class="nv">image</span> <span class="o">=</span> <span class="nf">generateQRCode</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">ppdString</span><span class="o">!</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p><strong>Objective-C</strong></p>
<pre class="highlight objective_c"><code><span class="k">@import</span> <span class="n">CoreImage</span><span class="p">;</span>

<span class="k">-</span> <span class="p">(</span><span class="n">UIImage</span> <span class="o">*</span><span class="p">)</span><span class="nf">generateQRCode</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">string</span> <span class="p">{</span>
    <span class="n">NSData</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">string</span> <span class="nf">dataUsingEncoding</span><span class="p">:</span><span class="n">NSUTF8StringEncoding</span><span class="p">];</span>
    <span class="n">CIFilter</span> <span class="o">*</span><span class="n">filter</span> <span class="o">=</span> <span class="p">[</span><span class="n">CIFilter</span> <span class="nf">filterWithName</span><span class="p">:</span><span class="s">@"CIQRCodeGenerator"</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">filter</span> <span class="o">||</span> <span class="o">!</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">nil</span><span class="p">;</span>

    <span class="p">[</span><span class="n">filter</span> <span class="nf">setValue</span><span class="p">:</span><span class="n">data</span> <span class="nf">forKey</span><span class="p">:</span><span class="s">@"inputMessage"</span><span class="p">];</span>
    <span class="n">CGAffineTransform</span> <span class="n">transform</span> <span class="o">=</span> <span class="n">CGAffineTransformMakeScale</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
    <span class="n">CIImage</span> <span class="o">*</span><span class="n">image</span> <span class="o">=</span> <span class="p">[[</span><span class="n">filter</span> <span class="nf">outputImage</span><span class="p">]</span> <span class="nf">imageByApplyingTransform</span><span class="p">:</span><span class="n">transform</span><span class="p">];</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">UIImage</span> <span class="nf">imageWithCIImage</span><span class="p">:</span><span class="n">image</span><span class="p">];</span>
<span class="p">}</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">generatePushPaymentQR</span> <span class="p">{</span>
    <span class="c1">// Generate
</span>    <span class="n">PushPaymentData</span> <span class="o">*</span><span class="n">pushPaymentData</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PushPaymentData</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
    <span class="c1">// Set required properties on push payment data e.g pushPaymentData.payloadFormatIndicator = @"01"
</span>
    <span class="n">MPQRError</span> <span class="o">*</span><span class="n">error</span><span class="p">;</span>
    <span class="n">NSString</span><span class="o">*</span> <span class="n">strQRCode</span> <span class="o">=</span> <span class="p">[</span><span class="n">pushPaymentData</span> <span class="nf">generatePushPaymentString</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Error: %@"</span><span class="p">,</span> <span class="n">error</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// Generate image
</span>        <span class="n">UIImage</span> <span class="o">*</span><span class="n">image</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span> <span class="nf">generateQRCode</span><span class="p">:</span> <span class="n">strQRCode</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>Copyright 2017 MasterCard. All rights reserved. Version (2.0.0)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.8.4</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
